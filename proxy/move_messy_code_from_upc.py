# Source Generated with Decompyle++
# File: move_messy_code_from_upc.pyc (Python 2.5)

'''
Move the messy code from synopsis of upc db temporarily for show.
'''
import os
from .config import UPC_DB_PATH
from .mda import Db
db = Db(UPC_DB_PATH)
data = []
data.append({
    'upc': '012569593220',
    'synopsis': "In the wake of a painful estrangement from his daughter, boxing trainer Frankie Dunn has been unwilling to let himself get close to anyone for a very long time--then Maggie Fitzgerald walks into his gym. In a life of constant struggle, Maggie's gotten herself this far on raw talent, unshakable focus and a tremendous force of will. But more than anything, she wants someone to believe in her. The last thing Frankie needs is that kind of responsibility-- let alone that kind of risk--but won over by Maggie's sheer determination, he begrudgingly agrees to take her on. In turns exasperating and inspiring each other, the two come to discover that they share a common spirit that transcends the pain and loss of their pasts, and they find in each other a sense of family they lost long ago. Yet, they both face a battle that will demand more heart and courage than any they've ever known." })
data.append({
    'upc': '024543266020',
    'synopsis': "Pete Garrison is a U.S. Secret Service agent who saved a president's life by jumping in front of a hail of bullets, over twenty years ago. Well-liked and respected by his colleagues, Garrison is a career agent who now heads the First Lady's detail. He lives in a high-level, orderly world of hierarchical structure, plans, maps, motorcades, code names, lingo and procedures. It's a universe that makes sense, until secrets begin to tear it apart. Pete's fellow agent and friend, Charlie Merriweather, hints at wanting to share critical and confidential information. Before that can happen, however, Merriweather is shot dead at his house in a crime that is made to look like a botched robbery. The investigation falls to the Secret Service's top investigative agent, David Breckinridge, a volatile combination of by-the-book and hothead, Garrison's protg , and, until recently one of Garrison's best friends. Breckinridge follows the evidence and scrupulously tries to avoid working from his gut. Garrison, as perhaps the greatest protective agent in the service, often has to work from pure instinct. Garrison's and Breckinridge's recent falling out was triggered by Breckindrige's mistaken belief that Garrison was having an affair with Breckinridge's now ex-wife. Jill Marin, a tough, sassy and ambitious young agent who just graduated second in her class at the Secret Service Academy, arrives for her first field posting. She has requested a work detail with Breckinridge because Garrison, while leading a field instruction exercise at the Academy told Jill that Breckenridge was the best investigator in the entire Service. Together the trio begins to uncover what appears to be an inside job to assassinate the president--a traitor in the ranks of the Secret Service. It's never happened in the institution's 141-year history. Suspicion ultimately falls on Garrison, who's going to find it extremely difficult to clear his name because someone is framing him. Whoever is framing Garrison knows he's vulnerable because he's devoting considerable effort to hiding a monumental secret. Suspected of being treasonous, Garrison goes on the run, pursued by Breckinridge and Marin--his own colleagues--as he tries to nail the real mole and save the president's life." })
data.append({
    'upc': '024543374336',
    'synopsis': "Robert Thorn is a senior American diplomat whose wife, Katherine, endures a difficult delivery where their newborn child has died. Thorn knows the news will devastate Katherine, who had suffered two previous miscarriages. The hospital priest presents Thorn with another child born that night, whose mother died in childbirth. The priest compels Thorn to take the infant boy as his own; Katherine will never know the truth, and their son, which they name Damien, will be raised as their flesh and blood. As the child turns five, unsettling events begin to occur: Damien's nanny hangs herself at the youngster's birthday party; a strange priest brings dire warnings to Thorn; a children's trip to the zoo results in a panicked frenzy; Damien becomes hysterical during a drive to church; and blurred movements in a series of photographs portend shocking deaths. Enter Mrs. Baylock, Damien's new nanny, who seems to have a preordained devotion to the child. Then tragedy strikes closer to home. But only later does Thorn comprehend the truth: Damien is no ordinary child; he is the long-prophesized Anti-Christ. Now, Thorn must make the ultimate sacrifice to prevent the unspeakable terror that awaits the world." })
data.append({
    'upc': '085392844524',
    'synopsis': 'Thirteen year-old Harry Potter has reluctantly spent yet another summer with the Dursleys, his dismal relatives, "behaving himself" and not practicing any magic. That is, until Uncle Vernon\'s bullying sister, Aunt Marge, comes to visit. Aunt Marge has always been particularly horrible to Harry and this time pushes him so far that he "accidentally" causes her to inflate like a monstrous balloon and drift away! Fearing punishment from his Aunt and Uncle--and repercussions from Hogwarts and the Ministry of Magic, which strictly forbids students from using magic in the non-magic world--Harry escapes into the night. Along the way, Harry will try to make sense of Hermione\'s puzzling appearances and disappearances, with the help of Ron and the giant Hagrid, who has taken on a new position at Hogwarts as the Care of Magical Creatures teacher. A confrontation between Harry and the menacing Sirius Black seems inevitable, but what exactly is Professor Lupin\'s relationship with Black? What is the dark secret that Professor Snape is so eager to reveal?  And just why is Ron\'s pet rat Scabbers so frantic to escape his grasp? Harry will need all of the courage, magic and support he can muster to answer these questions and uncover the truth behind Sirius Black and his ties to the gifted young wizard\'s mysterious past.' })
data.append({
    'upc': '097363459842',
    'directors': 'Alejandro Gonzalez Inarritu',
    'synopsis': "In the remote sands of the Moroccan desert, a rifle shot rings out--detonating a chain of events that will link an American tourist couple's frantic struggle to survive, two Moroccan boys involved in an accidental crime, a nanny illegally crossing into Mexico with two American children and a Japanese teen rebel whose father is sought by the police in Tokyo. Separated by clashing cultures and sprawling distances, each of these four disparate groups of people are nevertheless hurtling towards a shared destiny of isolation and grief. In the course of just a few days, they will each face the dizzying sensation of becoming profoundly lost--lost in the desert, lost to the world, lost to themselves--as they are pushed to the farthest edges of confusion and fear as well as to the very depths of connection and love." })
data.append({
    'upc': '794043107030',
    'synopsis': 'When Ted Crawford discovers that his beautiful younger wife, Jennifer, is having an affair, he plans her murder--the perfect murder. Among the cops arriving at the crime scene is hostage negotiator Detective Rob Nunally, the only officer permitted entry to the house. Surprisingly, Crawford readily admits to shooting his wife, but Nunally is too stunned to pay close attention when he recognizes his lover, whose true identity he never knew, lying on the floor in a pool of blood. Although Jennifer was shot at point blank range, Nunally realizes she isn\'t dead. Crawford is immediately arrested and arraigned after confessing--a seemingly slam-dunk case for hot shot assistant district attorney Willy Beachum, who has one foot out the door of the District Attorney\'s office on his way to a lucrative job in high-stakes corporate law. But nothing is as simple as it seems, including this case. Will the lure of power and a love affair with a sexy, ambitious attorney at his new firm overpower Willy\'s fierce drive to win, or worse, quash his code of ethics? In a tense duel of intellect and strategy, Crawford and Willy both learn that a "fracture" can be found in every ostensibly perfect fade.' })
data.append({
    'upc': '796019794657',
    'synopsis': "The ever-naive Cindy Campbell, seeking a career in home healthcare, finds work with a creepy old lady in an even creepier old house haunted by a ghostly presence. Throw in a good-looking guy next door and the threat of aliens intent on global domination and Cindy's instantly up to the top of her extremely blond head in danger. Our fearless heroine catapults into action once again struggling to decipher ominous messages from the beyond, looking for love in some very weird places and trying to save the world from mass destruction. As she struggles to discover life-saving answers, Cindy encounters horrific plane crashes, bodacious blind girls, village idiots, disheveled rappers, kinky contraptions, psycho survivalists, alien sphincters and even Oprah!" })
data.append({
    'upc': '012569593404',
    'synopsis': "When Josey Aimes returns to her hometown in Northern Minnesota after a failed marriage, she needs a good job. A single mother with two children, she turns to the predominant source of employment in the region--the iron mines. The mines provide a livelihood that has sustained a community for generations. It's an industry long dominated by men, in a place unaccustomed to change. Encouraged by her old friend Glory, one of the few female miners in town, Josey joins the ranks of those laboring to blast ore from rock in the gaping quarries. She is prepared for the back-breaking and often dangerous work, but coping with the harassment she and the other female miners encounter from their male coworkers proves far more challenging. The last thing the miners want is women competing for scarce jobs--women who, in their estimation, have no business driving trucks and hauling rock anyway. When Josey speaks out against the treatment she and her fellow workers face she is met with resistance--not only from those in power but from a community that doesn't want to hear the truth, her disapproving parents and many of her own colleagues who fear she is only making things worse. In time, even her friendship with Glory will be tested, her already difficult connection with her father, a lifelong miner, will be pushed to its limit and elements of her personal life exposed to scrutiny. The fallout from Josey's battle to make a better future for herself and her children will affect every aspect of her life, including her relationship with her young daughter and her sensitive teenage son, who must first cope with the embarrassment of his mother's sudden notoriety and then face harsh details of her past she was hoping he would never have to know. Through these struggles Josey will find the courage to stand up for what she believes in--even if that means standing alone." })
print('Move the messy code from synopsis of upc db temporarily for show.')
for row in data:
    
    try:
        sql = 'update upc set synopsis=:synopsis'
        if 'directors' in row:
            sql += ', directors=:directors'
        
        if 'starring' in row:
            sql += ', starring=:starring'
        
        sql += ' where upc=:upc;'
        db.update(sql, row)
        print('successfully update the synopsis of the upc(%s).' % row['upc'])
    except Exception as ex:
        print('failed to update the synopsis of the upc(%s): %s' % (row['upc'], str(ex)))


cmd = 'iconv -f utf-8 -t ascii -c %s > %s'
print('Get all upcs whose synopsis is not empty.')
sql = "select upc, synopsis from upc where synopsis!='' and synopsis is not null;"
rows = db.query(sql)
print('Update the synopsis.')
for row in rows:
    (upc, synopsis) = row
    original = '%s.original' % str(upc).strip()
    target = '%s.target' % str(upc).strip()
    f = open(original, 'w')
    f.write(synopsis)
    f.close()
    s = os.system(cmd % (original, target))
    f = open(target)
    synopsis = f.read()
    f.close()
    sql = 'update upc set synopsis=? where upc=?;'
    db.update(sql, (synopsis.replace('<br>', ''), upc))
    os.system('rm %s' % original)
    os.system('rm %s' % target)

print('Get all upcs whose starring is not empty.')
sql = "select upc, starring from upc where starring!='' and starring is not null;"
rows = db.query(sql)
print('Update the starring.')
for row in rows:
    (upc, starring) = row
    original = '%s.original' % str(upc).strip()
    target = '%s.target' % str(upc).strip()
    f = open(original, 'w')
    f.write(starring)
    f.close()
    s = os.system(cmd % (original, target))
    f = open(target)
    starring = f.read()
    f.close()
    sql = 'update upc set starring=? where upc=?;'
    db.update(sql, (starring, upc))
    os.system('rm %s' % original)
    os.system('rm %s' % target)

print('Get all upcs whose directors is not empty.')
sql = "select upc, directors from upc where directors!='' and directors is not null;"
rows = db.query(sql)
print('Update the directors.')
for row in rows:
    (upc, directors) = row
    original = '%s.original' % str(upc).strip()
    target = '%s.target' % str(upc).strip()
    f = open(original, 'w')
    f.write(directors)
    f.close()
    s = os.system(cmd % (original, target))
    f = open(target)
    directors = f.read()
    f.close()
    sql = 'update upc set directors=? where upc=?;'
    db.update(sql, (directors, upc))
    os.system('rm %s' % original)
    os.system('rm %s' % target)

del db
